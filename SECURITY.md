# Security Guidelines

## ğŸ”’ Sensitive Data Protection

### Never Commit:
- âŒ `.env` files with real credentials
- âŒ Private keys (`.pem`, `.key`, `.crt`)
- âŒ Database passwords
- âŒ API keys or tokens
- âŒ SSL certificates

### Always Use:
- âœ… Environment variables for secrets
- âœ… `.gitignore` for sensitive files
- âœ… `env.sample` as template (with fake data)
- âœ… Secrets managers in production (AWS Secrets Manager, HashiCorp Vault)

## ğŸ›¡ï¸ Security Best Practices

### Passwords
- **Development**: Any password (auto-generated recommended)
- **Staging**: Strong password (16+ chars, mixed case, numbers, symbols)
- **Production**: 
  - Minimum 32 characters
  - Generated by password manager
  - Rotated regularly
  - Never reused

### Database Connections
- **Local Dev**: `sslmode=disable` (acceptable)
- **Staging**: `sslmode=require` (mandatory)
- **Production**: `sslmode=verify-full` (mandatory)

### Docker Compose
- POSTGRES_PASSWORD **must** be set via environment
- Running without it will fail with clear error message
- Use: `POSTGRES_PASSWORD=yourpassword docker-compose up -d`

### API Security
- âœ… Non-root user in Docker (`nonroot:nonroot`)
- âœ… Input validation at domain layer
- âœ… SQL injection protection (parameterized queries)
- âœ… Error handling (no sensitive data in responses)
- âš ï¸ TODO: Add rate limiting
- âš ï¸ TODO: Add authentication/authorization
- âš ï¸ TODO: Add request logging

## ğŸš¨ If Credentials are Leaked

1. **Immediately** rotate all passwords
2. Revoke compromised API keys
3. Review git history: `git log --all -- .env`
4. Use BFG Repo-Cleaner if needed
5. Force push cleaned history
6. Notify team members

## ğŸ“ Environment Variables Checklist

Before deploying:
- [ ] POSTGRES_PASSWORD is set (not using default)
- [ ] DATABASE_URL uses SSL (`sslmode=require`)
- [ ] All `.env*` files are in `.gitignore`
- [ ] No hardcoded credentials in code
- [ ] Secrets are stored in secrets manager
- [ ] Passwords are strong and unique

## ğŸ” Security Scanning

```bash
# Check for committed secrets
git log --all -- .env .env.* *.pem *.key

# Scan for hardcoded secrets (install gitleaks first)
gitleaks detect --source . --verbose

# Check dependencies for vulnerabilities
go list -json -m all | nancy sleuth
```

## ğŸ“ Reporting Security Issues

If you discover a security vulnerability:
1. **DO NOT** open a public GitHub issue
2. Email: security@yourcompany.com
3. Include: description, steps to reproduce, impact
4. Allow time for fix before public disclosure

## ğŸ¯ Security Layers

1. **Application Layer**: Input validation, business rules
2. **Transport Layer**: HTTPS/TLS, no sensitive data in URLs
3. **Database Layer**: Encrypted connections, least privilege
4. **Infrastructure**: Firewall rules, VPC, security groups
5. **Secrets Management**: External secrets manager

---

**Last Updated**: 2026-01-10  
**Security Contact**: TBD
